{
    "Modified": "2018-02-08T12:29:00.190000",
    "Published": "2018-02-08T12:29:00.177000",
    "capec": [],
    "cvss": "6.8",
    "cwe": "CWE-416",
    "id": "CVE-2018-1000030",
    "last-modified": "2019-10-09T19:32:23.600000",
    "nessus": [
        {
            "NASL family": "SuSE Local Security Checks",
            "NASL id": "OPENSUSE-2018-511.NASL",
            "description": "This update for python fixes the following issues :\n\nSecurity issues fixed :\n\n  - CVE-2017-1000158: Fixed integer overflows in     PyString_DecodeEscape that could have resulted in     heap-based buffer overflow attacks and possible     arbitrary code execution (bsc#1068664).\n\n  - CVE-2018-1000030: Fixed crash inside the Python     interpreter when multiple threads used the same I/O     stream concurrently (bsc#1079300).\n\nThis update was imported from the SUSE:SLE-12-SP1:Update update project.",
            "last seen": "2019-02-21",
            "modified": "2018-05-24",
            "plugin id": "110069",
            "published": "2018-05-24",
            "reporter": "Tenable",
            "source": "https://www.tenable.com/plugins/index.php?view=single&id=110069",
            "title": "openSUSE Security Update : python (openSUSE-2018-511)"
        },
        {
            "NASL family": "SuSE Local Security Checks",
            "NASL id": "SUSE_SU-2018-1372-1.NASL",
            "description": "This update for python fixes the following issues: Security issues fixed :\n\n  - CVE-2017-1000158: Fixed integer overflows in     PyString_DecodeEscape that could have resulted in     heap-based buffer overflow attacks and possible     arbitrary code execution (bsc#1068664).\n\n  - CVE-2018-1000030: Fixed crash inside the Python     interpreter when multiple threads used the same I/O     stream concurrently (bsc#1079300).\n\nNote that Tenable Network Security has extracted the preceding description block directly from the SUSE security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues.",
            "last seen": "2019-02-21",
            "modified": "2018-12-01",
            "plugin id": "110037",
            "published": "2018-05-23",
            "reporter": "Tenable",
            "source": "https://www.tenable.com/plugins/index.php?view=single&id=110037",
            "title": "SUSE SLED12 / SLES12 Security Update : python (SUSE-SU-2018:1372-1)"
        },
        {
            "NASL family": "Ubuntu Local Security Checks",
            "NASL id": "UBUNTU_USN-3817-1.NASL",
            "description": "It was discovered that Python incorrectly handled large amounts of data. A remote attacker could use this issue to cause Python to crash, resulting in a denial of service, or possibly execute arbitrary code.\nThis issue only affected Ubuntu 14.04 LTS and Ubuntu 16.04 LTS.\n(CVE-2018-1000030)\n\nIt was discovered that Python incorrectly handled running external commands in the shutil module. A remote attacker could use this issue to cause Python to crash, resulting in a denial of service, or possibly execute arbitrary code. (CVE-2018-1000802)\n\nIt was discovered that Python incorrectly used regular expressions vulnerable to catastrophic backtracking. A remote attacker could possibly use this issue to cause a denial of service. This issue only affected Ubuntu 14.04 LTS and Ubuntu 16.04 LTS. (CVE-2018-1060, CVE-2018-1061)\n\nIt was discovered that Python failed to initialize Expat's hash salt.\nA remote attacker could possibly use this issue to cause hash collisions, leading to a denial of service. (CVE-2018-14647).\n\nNote that Tenable Network Security has extracted the preceding description block directly from the Ubuntu security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues.",
            "last seen": "2019-02-21",
            "modified": "2018-12-19",
            "plugin id": "118954",
            "published": "2018-11-14",
            "reporter": "Tenable",
            "source": "https://www.tenable.com/plugins/index.php?view=single&id=118954",
            "title": "Ubuntu 14.04 LTS / 16.04 LTS / 18.04 LTS : python2.7, python3.4, python3.5 vulnerabilities (USN-3817-1)"
        },
        {
            "NASL family": "PhotonOS Local Security Checks",
            "NASL id": "PHOTONOS_PHSA-2018-2_0-0037.NASL",
            "description": "An update of {'mercurial', 'python2', 'zsh', 'pycrypto', 'patch', 'binutils', 'paramiko', 'httpd', 'mysql', 'xerces-c', 'util-linux', 'net-snmp', 'python3', 'sqlite'} packages of Photon OS has been released.",
            "last seen": "2019-02-21",
            "modified": "2019-02-07",
            "plugin id": "111297",
            "published": "2018-07-24",
            "reporter": "Tenable",
            "source": "https://www.tenable.com/plugins/index.php?view=single&id=111297",
            "title": "Photon OS 2.0 : Zsh / Python3 / Xerces / Mercurial / Pmd / Pycrypto / Net / Python2 / Util / Mysql / Paramiko / Binutils / Patch / Sqlite (PhotonOS-PHSA-2018-2.0-0037) (deprecated)"
        },
        {
            "NASL family": "PhotonOS Local Security Checks",
            "NASL id": "PHOTONOS_PHSA-2018-1_0-0125_PYTHON2.NASL",
            "description": "An update of the python2 package has been released.",
            "last seen": "2019-02-08",
            "modified": "2019-02-07",
            "plugin id": "121820",
            "published": "2019-02-07",
            "reporter": "Tenable",
            "source": "https://www.tenable.com/plugins/index.php?view=single&id=121820",
            "title": "Photon OS 1.0: Python2 PHSA-2018-1.0-0125"
        },
        {
            "NASL family": "Gentoo Local Security Checks",
            "NASL id": "GENTOO_GLSA-201811-02.NASL",
            "description": "The remote host is affected by the vulnerability described in GLSA-201811-02 (Python: Buffer overflow)\n\n    A buffer overflow vulnerability have been discovered in Python. Please       review the CVE identifiers referenced below for details.\n  Impact :\n\n    A remote attacker, in special situations such as function as a service,       could violate a trust boundary and cause a Denial of Service condition.\n  Workaround :\n\n    There is no known workaround at this time.",
            "last seen": "2019-02-21",
            "modified": "2018-11-09",
            "plugin id": "118846",
            "published": "2018-11-09",
            "reporter": "Tenable",
            "source": "https://www.tenable.com/plugins/index.php?view=single&id=118846",
            "title": "GLSA-201811-02 : Python: Buffer overflow"
        },
        {
            "NASL family": "PhotonOS Local Security Checks",
            "NASL id": "PHOTONOS_PHSA-2018-1_0-0125.NASL",
            "description": "An update of 'python2' packages of Photon OS has been released.",
            "last seen": "2019-02-08",
            "modified": "2019-02-07",
            "plugin id": "111929",
            "published": "2018-08-17",
            "reporter": "Tenable",
            "source": "https://www.tenable.com/plugins/index.php?view=single&id=111929",
            "title": "Photon OS 1.0: Python2 PHSA-2018-1.0-0125 (deprecated)"
        },
        {
            "NASL family": "Huawei Local Security Checks",
            "NASL id": "EULEROS_SA-2018-1078.NASL",
            "description": "According to the version of the python packages installed, the EulerOS installation on the remote host is affected by the following vulnerability :\n\n  - python 2.7.14 is vulnerable to a Heap-Buffer-Overflow     as well as a Heap-Use-After-Free. Python versions prior     to 2.7.14 may also be vulnerable and it appears that     Python 2.7.17 and prior may also be vulnerable however     this has not been confirmed. The vulnerability lies     when multiply threads are handling large amounts of     data. In both cases there is essentially a race     condition that occurs. For the Heap-Buffer-Overflow,     Thread 2 is creating the size for a buffer, but Thread1     is already writing to the buffer without knowing how     much to write. So when a large amount of data is being     processed, it is very easy to cause memory corruption     using a Heap-Buffer-Overflow. As for the     Use-After-Free,     Thread3->Malloc->Thread1->Free's->Thread2-Re-uses-Free'     d Memory. The PSRT has stated that this is not a     security vulnerability due to the fact that the     attacker must be able to run code, however in some     situations, such as function as a service, this     vulnerability can potentially be used by an attacker to     violate a trust boundary, as such the DWF feels this     issue deserves a CVE.(CVE-2018-1000030)\n\nNote that Tenable Network Security has extracted the preceding description block directly from the EulerOS security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues.",
            "last seen": "2019-02-21",
            "modified": "2018-11-13",
            "plugin id": "109476",
            "published": "2018-05-02",
            "reporter": "Tenable",
            "source": "https://www.tenable.com/plugins/index.php?view=single&id=109476",
            "title": "EulerOS 2.0 SP1 : python (EulerOS-SA-2018-1078)"
        }
    ],
    "ranking": [
        [
            {
                "circl": 3
            }
        ]
    ],
    "references": [
        "https://bugs.python.org/issue31530",
        "https://drive.google.com/file/d/1oyR9DAZjZK_SCn3mor6NRAYLJS6ueXaY/view",
        "https://security.gentoo.org/glsa/201811-02",
        "https://usn.ubuntu.com/3817-1/",
        "https://usn.ubuntu.com/3817-2/",
        "https://www.dropbox.com/sh/sj3ee7xv55j36k7/AADwP-YfOYikBMuy32e0uvPFa?dl=0"
    ],
    "refmap": {
        "confirm": [
            "https://bugs.python.org/issue31530"
        ],
        "gentoo": [
            "GLSA-201811-02"
        ],
        "misc": [
            "https://drive.google.com/file/d/1oyR9DAZjZK_SCn3mor6NRAYLJS6ueXaY/view",
            "https://www.dropbox.com/sh/sj3ee7xv55j36k7/AADwP-YfOYikBMuy32e0uvPFa?dl=0"
        ],
        "ubuntu": [
            "USN-3817-1",
            "USN-3817-2"
        ]
    },
    "summary": "Python 2.7.14 is vulnerable to a Heap-Buffer-Overflow as well as a Heap-Use-After-Free. Python versions prior to 2.7.14 may also be vulnerable and it appears that Python 2.7.17 and prior may also be vulnerable however this has not been confirmed. The vulnerability lies when multiply threads are handling large amounts of data. In both cases there is essentially a race condition that occurs. For the Heap-Buffer-Overflow, Thread 2 is creating the size for a buffer, but Thread1 is already writing to the buffer without knowing how much to write. So when a large amount of data is being processed, it is very easy to cause memory corruption using a Heap-Buffer-Overflow. As for the Use-After-Free, Thread3->Malloc->Thread1->Free's->Thread2-Re-uses-Free'd Memory. The PSRT has stated that this is not a security vulnerability due to the fact that the attacker must be able to run code, however in some situations, such as function as a service, this vulnerability can potentially be used by an attacker to violate a trust boundary, as such the DWF feels this issue deserves a CVE.",
    "vulnerable_configuration": [
        {
            "id": "cpe:2.3:a:python:python:2.7.14",
            "title": "Python 2.7.14"
        },
        {
            "id": "cpe:2.3:o:canonical:ubuntu_linux:12.04:-:-:-:esm",
            "title": "Canonical Ubuntu Linux 12.04 ESM (Extended Security Maintenance)"
        },
        {
            "id": "cpe:2.3:o:canonical:ubuntu_linux:14.04:-:-:-:lts",
            "title": "Canonical Ubuntu Linux  14.04 LTS (Long-Term Support)"
        },
        {
            "id": "cpe:2.3:o:canonical:ubuntu_linux:16.04:-:-:-:lts",
            "title": "Canonical Ubuntu Linux 16.04  LTS (Long-Term Support)"
        },
        {
            "id": "cpe:2.3:o:canonical:ubuntu_linux:18.04:-:-:-:lts",
            "title": "Canonical Ubuntu Linux 18.04 LTS Edition"
        }
    ],
    "vulnerable_configuration_cpe_2_2": [
        "cpe:/a:python:python:2.7.14",
        "cpe:/o:canonical:ubuntu_linux:12.04::~~esm~~~",
        "cpe:/o:canonical:ubuntu_linux:14.04::~~lts~~~",
        "cpe:/o:canonical:ubuntu_linux:16.04::~~lts~~~",
        "cpe:/o:canonical:ubuntu_linux:18.04::~~lts~~~"
    ]
}